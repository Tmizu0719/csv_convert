# csv_convert
 this program converts csv file to matrix 

このプログラムはヘッダーを持つcsvファイルを，ヘッダーとデータにそれぞれlistとnumpyarrayの形式に変換し，のちのデータ処理を容易く行うためのプログラムである．

欠損データはnumpy.nanで穴埋めされる．

また簡易的な機能として，欠損データ削除と欠損データの置換を行えるようにした．

添付している テストデータは３，６行目に欠損データを与えている．


～～使い方～～

CC = CsvConvert()                                         ＃クラスを作成

header, data = CC.convert_np("csv_matrix/test_data.csv")  ＃パスを引数として入力，ヘッダーとデータの変数名を指定する．


上記の例だとheaderにはヘッダーのlist, dataにはヘッダー以下の数値データのnumpy.arrayが格納される．変数名を指定しない場合，タプルの中にheader, dataが格納される．


〇欠損データの削除

欠損データを含む行を削除する．このとき削除した行数（ヘッダーを除き，1から始まる．）がprintされる．

欠損データがない場合，元の行列が返る．

CC.delete_nanrow(data)  ＃引数にnumpy.arrayを入力


〇欠損データの置換

欠損データを検索して2引数に入力した数値で置換する．

CC.replace_nan(data, 0)  ＃１引数はnumpy.array, ２引数は置換したい数値（この例では０）


※他のプログラムにインポートして使用したい場合は，他のプログラムと同じディレクトリ内にこのプログラムを置き，他のプログラムで
from csv_convert import CsvConvert
でインポートして使用する．


# csv_graph.py  
このプログラムはcsvファイル（カンマ切り以外も可能）からグラフを作成するものである．  
このプログラムを使用する際にはカントディレクトリ内に以下のpythonファイルを置いておく必要がある．  
csv_convert.py, fun_ConvertFilename.py, graph.py, Gui.py   
 
csv_graph.pyの17行目から２４行目までがグラフ体裁や読み込みファイルのパラメータとなっている．    
    filetype: 読み込むファイルの拡張子の設定（csv）  
    base: x軸に当てはめるcsvファイル中の列番号（０から数える）  
    xlabel, ylabel: 描写するグラフのx,yの軸ラベルの名前（$\it{}のようにtex風に入力もできる）  
    xmin, xmax: x軸スケールの最小値，最大値  
    ymin, ymax: y軸スケールの最小値，最大値  

本プログラムを起動すると，まずcsvファイルを読み込むためのGUIが出る．  
作成したいファイルを指定して赤いボタンを押す．（複数選択して同時にグラフの作成をすることもできる）  
その後自動でグラフが作成され，グラフが描写され元のcsvファイルのディレクトリにグラフが保存される．（複数選択した際には描写されたグラフを閉じないと次のcsvファイルの処理がされない．）


# csv_connect.py
このプログラムは複数の同フォーマットのcsvファイルを読み込み，特定の列（計測点座標等）を保持しつつ，指定した列のcsvファイルを合わせた平均，RMSを計算してそれらをcsvファイルと平均のグラフとして出力する．  
このプログラムを使用する際にはカントディレクトリ内に以下のpythonファイルを置いておく必要がある．  
csv_convert.py, fun_ConvertFilename.py, graph.py, Gui.py, fun_rms.py  

csv_connect.pyの19行目から27行目までがグラフ体裁や読み込みファイルのパラメータとなっている．    
    filetype: 読み込むファイルの拡張子の設定（csv）  
    base: x軸に当てはめるcsvファイル中の列番号（０から数える）例：計測点座標等  
    volum: ファイルごとに変化をしてそれらの平均，RMSを取得したい列（複数可）
    xlabel, ylabel: 描写するグラフのx,yの軸ラベルの名前（$\it{}のようにtex風に入力もできる）  
    xmin, xmax: x軸スケールの最小値，最大値  
    ymin, ymax: y軸スケールの最小値，最大値  

本プログラムを起動すると，まずcsvファイルを読み込むためのGUIが出る．  
そこで複数の同フォーマットのcsvファイルを選択する．  
その後プログラムのパラメータを参照して自動で平均，RMSを実行し，平均のグラフを出力する．  
また保持列・平均・RMSの順で列になっているcsvファイルを出力する．  
※平均およびRMSを行う列を複数選択した場合，次のような順でcsvファイルの中身が書き込まれる．  
    保持列・平均１・平均２・...・RMS1・RMS2・...  
出力されるcsvファイルおよびグラフのファイル名は，初めに指定したcsvファイル名中の数字列を抽出し，同様に最後のcsvファイル中から数字列を抽出して，出力ファイル名として使用する．